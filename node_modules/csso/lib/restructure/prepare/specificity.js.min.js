import{parse}from"css-tree";function ensureSelectorList(e){return"Raw"===e.type?parse(e.value,{context:"selectorList"}):e}function maxSpecificity(e,t){for(let c=0;c<3;c++)if(e[c]!==t[c])return e[c]>t[c]?e:t;return e}function maxSelectorListSpecificity(e){return ensureSelectorList(e).children.reduce((e,t)=>maxSpecificity(specificity(t),e),[0,0,0])}function specificity(e){let t=0,c=0,s=0;return e.children.forEach(e=>{switch(e.type){case"IdSelector":t++;break;case"ClassSelector":case"AttributeSelector":c++;break;case"PseudoClassSelector":switch(e.name.toLowerCase()){case"not":case"has":case"is":case"matches":case"-webkit-any":case"-moz-any":{const[r,i,a]=maxSelectorListSpecificity(e.children.first);t+=r,c+=i,s+=a;break}case"nth-child":case"nth-last-child":{const r=e.children.first;if("Nth"===r.type&&r.selector){const[e,i,a]=maxSelectorListSpecificity(r.selector);t+=e,c+=i+1,s+=a}else c++;break}case"where":break;case"before":case"after":case"first-line":case"first-letter":s++;break;default:c++}break;case"TypeSelector":e.name.endsWith("*")||s++;break;case"PseudoElementSelector":s++}}),[t,c,s]}export default specificity;