import{isHexDigit,cmpChar,Ident,Delim,Number as NumberToken,Dimension}from"../tokenizer/index.js";const PLUSSIGN=43,HYPHENMINUS=45,QUESTIONMARK=63,U=117;function isDelim(e,n){return null!==e&&e.type===Delim&&e.value.charCodeAt(0)===n}function startsWith(e,n){return e.value.charCodeAt(0)===n}function hexSequence(e,n,t){let i=0;for(let r=n;r<e.value.length;r++){const u=e.value.charCodeAt(r);if(45===u&&t&&0!==i)return hexSequence(e,n+i+1,!1),6;if(!isHexDigit(u))return 0;if(++i>6)return 0}return i}function withQuestionMarkSequence(e,n,t){if(!e)return 0;for(;isDelim(t(n),63);){if(++e>6)return 0;n++}return n}export default function urange(e,n){let t=0;if(null===e||e.type!==Ident||!cmpChar(e.value,0,U))return 0;if(null===(e=n(++t)))return 0;if(isDelim(e,43))return null===(e=n(++t))?0:e.type===Ident?withQuestionMarkSequence(hexSequence(e,0,!0),++t,n):isDelim(e,63)?withQuestionMarkSequence(1,++t,n):0;if(e.type===NumberToken){const i=hexSequence(e,1,!0);return 0===i?0:null===(e=n(++t))?t:e.type===Dimension||e.type===NumberToken?startsWith(e,45)&&hexSequence(e,1,!1)?t+1:0:withQuestionMarkSequence(i,t,n)}return e.type===Dimension?withQuestionMarkSequence(hexSequence(e,1,!0),++t,n):0}