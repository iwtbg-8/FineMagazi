import{isHexDigit,isWhiteSpace,isValidEscape,consumeEscaped,decodeEscaped}from"../tokenizer/index.js";const SPACE=32,REVERSE_SOLIDUS=92,QUOTATION_MARK=34,APOSTROPHE=39,LEFTPARENTHESIS=40,RIGHTPARENTHESIS=41;export function decode(e){const t=e.length;let c=4,o=41===e.charCodeAt(t-1)?t-2:t-1,r="";for(;c<o&&isWhiteSpace(e.charCodeAt(c));)c++;for(;c<o&&isWhiteSpace(e.charCodeAt(o));)o--;for(let i=c;i<=o;i++){let c=e.charCodeAt(i);if(92===c){if(i===o){i!==t-1&&(r=e.substr(i+1));break}if(c=e.charCodeAt(++i),isValidEscape(92,c)){const t=i-1,c=consumeEscaped(e,t);i=c-1,r+=decodeEscaped(e.substring(t+1,c))}else 13===c&&10===e.charCodeAt(i+1)&&i++}else r+=e[i]}return r}export function encode(e){let t="",c=!1;for(let o=0;o<e.length;o++){const r=e.charCodeAt(o);0!==r?r<=31||127===r?(t+="\\"+r.toString(16),c=!0):32===r||92===r||34===r||39===r||40===r||41===r?(t+="\\"+e.charAt(o),c=!1):(c&&isHexDigit(r)&&(t+=" "),t+=e.charAt(o),c=!1):t+="ï¿½"}return"url("+t+")"}