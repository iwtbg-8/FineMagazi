"use strict";import{AST_Node}from"../ast.js";function characters(t){return t.split("")}function member(t,n){return n.includes(t)}class DefaultsError extends Error{constructor(t,n){super(),this.name="DefaultsError",this.message=t,this.defs=n}}function defaults(t,n,e){!0===t?t={}:null!=t&&"object"==typeof t&&(t={...t});const r=t||{};if(e)for(const t in r)if(HOP(r,t)&&!HOP(n,t))throw new DefaultsError("`"+t+"` is not a supported option",n);for(const e in n)if(HOP(n,e))if(t&&HOP(t,e))if("ecma"===e){let n=0|t[e];n>5&&n<2015&&(n+=2009),r[e]=n}else r[e]=t&&HOP(t,e)?t[e]:n[e];else r[e]=n[e];return r}function noop(){}function return_false(){return!1}function return_true(){return!0}function return_this(){return this}function return_null(){return null}var MAP=function(){function t(t,e,r=!0){const o=[];for(let s=0;s<t.length;++s){let u=t[s].transform(e,r);u instanceof AST_Node?o.push(u):u instanceof n&&o.push(...u.v)}return o}function n(t){this.v=t}return t.splice=function(t){return new n(t)},t.skip={},t}();function make_node(t,n,e){return e||(e={}),n&&(e.start||(e.start=n.start),e.end||(e.end=n.end)),new t(e)}function push_uniq(t,n){t.includes(n)||t.push(n)}function string_template(t,n){return t.replace(/{(.+?)}/g,function(t,e){return n&&n[e]})}function remove(t,n){for(var e=t.length;--e>=0;)t[e]===n&&t.splice(e,1)}function mergeSort(t,n){if(t.length<2)return t.slice();return function t(e){if(e.length<=1)return e;var r=Math.floor(e.length/2),o=e.slice(0,r),s=e.slice(r);return function(t,e){for(var r=[],o=0,s=0,u=0;o<t.length&&s<e.length;)n(t[o],e[s])<=0?r[u++]=t[o++]:r[u++]=e[s++];return o<t.length&&r.push.apply(r,t.slice(o)),s<e.length&&r.push.apply(r,e.slice(s)),r}(o=t(o),s=t(s))}(t)}function makePredicate(t){return Array.isArray(t)||(t=t.split(" ")),new Set(t.sort())}function map_add(t,n,e){t.has(n)?t.get(n).push(e):t.set(n,[e])}function map_from_object(t){var n=new Map;for(var e in t)HOP(t,e)&&"$"===e.charAt(0)&&n.set(e.substr(1),t[e]);return n}function map_to_object(t){var n=Object.create(null);return t.forEach(function(t,e){n["$"+e]=t}),n}function HOP(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function keep_name(t,n){return!0===t||t instanceof RegExp&&t.test(n)}var lineTerminatorEscape={"\0":"0","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function regexp_source_fix(t){return t.replace(/[\0\n\r\u2028\u2029]/g,function(n,e){return("\\"==t[e-1]&&("\\"!=t[e-2]||/(?:^|[^\\])(?:\\{2})*$/.test(t.slice(0,e-1)))?"":"\\")+lineTerminatorEscape[n]})}const re_safe_regexp=/^[\\/|\0\s\w^$.[\]()]*$/;export const regexp_is_safe=t=>re_safe_regexp.test(t);const all_flags="dgimsuyv";function sort_regexp_flags(t){const n=new Set(t.split(""));let e="";for(const t of all_flags)n.has(t)&&(e+=t,n.delete(t));return n.size&&n.forEach(t=>{e+=t}),e}function has_annotation(t,n){return t._annotations&n}function set_annotation(t,n){t._annotations|=n}function clear_annotation(t,n){t._annotations&=~n}export{characters,defaults,HOP,keep_name,make_node,makePredicate,map_add,map_from_object,map_to_object,MAP,member,mergeSort,noop,push_uniq,regexp_source_fix,remove,return_false,return_null,return_this,return_true,sort_regexp_flags,string_template,has_annotation,set_annotation,clear_annotation};