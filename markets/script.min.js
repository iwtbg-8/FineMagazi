function loadCommonNav(e){const n=document.getElementById("nav-placeholder");if(!n)return;const t=["nav.html","../nav.html","/nav.html"];let o=0;(function e(){if(o>=t.length)return console.error("loadCommonNav: failed to load nav.html from any candidate path:",t),Promise.reject(new Error("Failed to load nav.html"));const n=t[o++];return fetch(n).then(n=>n.ok?n.text():e()).catch(()=>e())})().then(t=>{if(!t)return;const o=window.location.pathname,a=o.split("/").filter(Boolean);a.length&&"/"!==o[o.length-1]&&a.pop();let l="";for(let e=0;e<a.length;e++)l+="../";const s=document.createElement("div");s.innerHTML=t;s.querySelectorAll("a[href]").forEach(e=>{const n=e.getAttribute("href");n&&(n.startsWith("http://")||n.startsWith("https://")||n.startsWith("/")||n.startsWith("#")||e.setAttribute("href",l+n))}),n.innerHTML=s.innerHTML,"function"==typeof e&&e()}).catch(e=>{console.error("loadCommonNav: unable to load nav.html",e)})}let nav=null;const menuBtn=document.createElement("button");menuBtn.innerText="☰",menuBtn.id="menu-btn",menuBtn.style.fontSize="1.5rem",menuBtn.style.background="none",menuBtn.style.border="none",menuBtn.style.cursor="pointer",menuBtn.style.display="none",menuBtn.style.color="var(--text-dark)",menuBtn.className="menu-btn";const headerEl=document.querySelector("header");function updateMenuBtnColor(e){menuBtn.style.color=e?"#eee":"#111"}function handleResize(){nav&&(window.innerWidth<=768?(menuBtn.style.display="block",nav.style.display="none",nav.classList.remove("mobile-nav-open")):(menuBtn.style.display="none",nav.style.display="flex",nav.style.flexDirection="row",nav.style.gap="1.5rem",nav.style.position="static",nav.style.background="none",nav.style.border="none",nav.style.boxShadow="none",nav.style.padding="0",nav.classList.remove("mobile-nav-open")))}headerEl&&headerEl.appendChild(menuBtn),menuBtn.addEventListener("click",()=>{nav&&(nav.classList.contains("mobile-nav-open")?(nav.classList.remove("mobile-nav-open"),nav.style.display="none",menuBtn.innerHTML="☰"):(nav.classList.add("mobile-nav-open"),nav.style.display="flex",nav.style.flexDirection="column",nav.style.gap="1rem",menuBtn.innerHTML="×"))}),document.addEventListener("click",e=>{nav&&window.innerWidth<=768&&nav.classList.contains("mobile-nav-open")&&!nav.contains(e.target)&&!menuBtn.contains(e.target)&&(nav.classList.remove("mobile-nav-open"),nav.style.display="none",menuBtn.innerHTML="☰")}),window.addEventListener("DOMContentLoaded",()=>{loadCommonNav(()=>{nav=document.querySelector("#nav-placeholder nav"),nav&&handleResize()})}),window.addEventListener("resize",handleResize);const backToTop=document.createElement("button");backToTop.innerText="↑ Top",backToTop.id="back-to-top",backToTop.style.position="fixed",backToTop.style.bottom="20px",backToTop.style.right="20px",backToTop.style.padding="10px 15px",backToTop.style.fontSize="1rem",backToTop.style.background="#0077cc",backToTop.style.color="#fff",backToTop.style.border="none",backToTop.style.borderRadius="5px",backToTop.style.cursor="pointer",backToTop.style.display="none",document.body.appendChild(backToTop),window.addEventListener("scroll",()=>{window.scrollY>300?backToTop.style.display="block":backToTop.style.display="none"}),backToTop.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const darkModeBtn=document.getElementById("dark-mode"),body=document.body,localStorageKey="themePreference";function applyTheme(e){e?(body.classList.add("dark"),darkModeBtn.textContent="☀️ Light Mode"):(body.classList.remove("dark"),darkModeBtn.textContent="🌙 Dark Mode"),updateMenuBtnColor(e);try{window.dispatchEvent(new Event("theme-change"))}catch(e){}}window.addEventListener("load",()=>{handleResize();const e=localStorage.getItem(localStorageKey);let n=!1;"dark"===e?n=!0:null===e&&window.matchMedia&&(n=window.matchMedia("(prefers-color-scheme: dark)").matches),applyTheme(n)}),darkModeBtn.addEventListener("click",()=>{const e=!body.classList.contains("dark");applyTheme(e);const n=e?"dark":"light";localStorage.setItem(localStorageKey,n)});