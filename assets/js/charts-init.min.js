!function(){function e(e){var t=document.getElementById(e+"-config");if(!t)return null;try{return JSON.parse(t.textContent)}catch(t){return console.error("Invalid JSON for",e,t),null}}function t(){if(window&&window.console&&window.console.debug)try{window.console.debug.apply(console,arguments)}catch(e){window.console.log.apply(console,arguments)}}function n(e){return"$"+Number(e).toLocaleString()}function a(e,t,a,o,r){return new Chart(e,Object.assign({type:"line",data:{labels:t,datasets:a},options:Object.assign({responsive:!0,plugins:{legend:{display:!0},title:{display:!!o,text:o}},scales:{y:{beginAtZero:!0,ticks:{callback:n}},x:{title:{display:!0}}}},r||{})},{}))}function o(e){for(var t=e.startAge||25,n=e.endAge||65,a=[],o=t;o<=n;o++)a.push(o);for(var r=Math.pow(1+(e.annualReturn||0)/1,1/12)-1,i=[],l=0,d=e.investYears||0,s=0;s<a.length;s++){for(var c=0;c<12;c++){if("periodic"===e.mode&&s<d&&(l+=e.monthlyInvestment||0),"periodic-range"===e.mode){var u=t+s;u>=(e.investStartAge||0)&&u<=(e.investEndAge||0)&&(l+=e.monthlyInvestment||0)}l*=1+r}i.push(Number(l.toFixed(2)))}return{labels:a,data:i}}function r(){function r(){t("[charts-init] Chart.js found:",!!window.Chart),["aliceCompoundChart","bobCompoundChart","comparisonCompoundChart","comparisonInvestmentChart","longTermCompoundChart"].forEach(function(r){var i=document.getElementById(r+"-config");if(i){var l,d,s,c,u=JSON.parse(i.textContent);if(t("[charts-init] initAll - found config for",r,"mode=",u.mode),"compare"===u.mode)!function(n){var r=e(n);if(r){var i=document.getElementById(n);if(i){var l=null,d=[];(r.series||[]).forEach(function(e){var t=document.getElementById(e+"-config");if(t)try{var n=JSON.parse(t.textContent),a=o(n);l=a.labels,d.push({label:n.label||e,data:a.data,borderColor:n.color||(d.length?"#e27a2a":"#2a7ae2"),backgroundColor:d.length?"rgba(226,122,42,0.08)":"rgba(42,122,226,0.08)",fill:!1,pointRadius:1.5,tension:.15})}catch(t){console.error("parse",e,t)}}),t("[charts-init] initCompare:",n,"series count=",d.length),l&&d.length&&a(i.getContext("2d"),l,d,r.title||"")}}}(r);else if("periodic"===u.mode||"periodic-range"===u.mode)!function(n){var r=document.getElementById(n);if(r){var i=e(n);if(i&&(t("[charts-init] initOne:",n,i.mode),"periodic"===i.mode||"periodic-range"===i.mode)){var l=o(i);a(r.getContext("2d"),l.labels,[{label:i.label||"Value",data:l.data,borderColor:i.color||"#2a7ae2",backgroundColor:"rgba(42,122,226,0.1)",fill:!0,pointRadius:2,tension:.15}],i.title||"")}}}(r);else if("longterm"===u.mode){if(!(f=document.getElementById(r)))return;var p=function(e){for(var t=e.startAge||25,n=e.years||40,a=[],o=0;o<n;o++)a.push(t+o);for(var r=Math.pow(1+(e.annualReturn||0),1/12)-1,i=[],l=0,d=0;d<n;d++){for(var s=0;s<12;s++)l+=e.monthlyInvestment||0,l*=1+r;i.push(Number(l.toFixed(2)))}return{labels:a,data:i}}(u);l=f.getContext("2d"),d=p.labels,s={label:u.label||"Value",data:p.data,backgroundColor:"rgba(42,122,226,0.45)",borderColor:"#2a7ae2",borderWidth:1},c=u.title||"",new Chart(l,{type:"bar",data:{labels:d,datasets:[s]},options:{responsive:!0,plugins:{legend:{display:!1},title:{display:!!c,text:c}},scales:{y:{beginAtZero:!0,ticks:{callback:n}},x:{title:{display:!0}}}}})}else if("investment-compare"===u.mode){var f;if(!(f=document.getElementById(r)))return;var m=function(e){var t=e.years||[0,5,10,15,20,25,30,35,40],n=t.map(function(e){return e+" yrs"}),a=[];return(e.series||[]).forEach(function(e,n){var o=t.map(function(t){return"monthly"===e.compound?Number((e.principal*Math.pow(1+e.rate/12,12*t)).toFixed(2)):Number((e.principal*Math.pow(1+e.rate,t)).toFixed(2))});a.push({label:e.label||"series"+n,data:o,borderColor:n?"#e27a2a":"#2a7ae2",backgroundColor:n?"rgba(226,122,42,0.08)":"rgba(42,122,226,0.08)",fill:!1,pointRadius:2,tension:.15})}),{labels:n,datasets:a}}(u);a(f.getContext("2d"),m.labels,m.datasets,u.title||"")}}})}if(window.Chart)r();else{t("[charts-init] Chart.js not present yet, waiting to initialize...");var i=0,l=setInterval(function(){if(i++,window.Chart)return clearInterval(l),t("[charts-init] Chart.js detected after wait, initializing now"),void r();i>=25&&(clearInterval(l),console.warn("Chart.js not loaded after waiting "+200*i+"ms"))},200)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r()}();